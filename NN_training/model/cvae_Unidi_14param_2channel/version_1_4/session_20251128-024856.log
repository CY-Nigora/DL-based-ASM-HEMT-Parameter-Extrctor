[log] tee initialized at 2025-11-28 02:48:56 -> temp_Unidi_cvae_14param_2channel\session_20251128-024856.log
Using CUDA device 0: NVIDIA GeForce RTX 4060 Laptop GPU
[log] tee initialized at 2025-11-28 02:48:59 -> temp_Unidi_cvae_14param_2channel\cvae_20251128-024859\train.log
[Data] Warning: Single measurement sample detected. Duplicating to N=2 for BatchNorm compatibility.
[Info] Loading dual proxies from temp_Unidi_cvae_14param_2channel/proxy_dual
[L_trust] using 20000 ref rows from temp_Unidi_cvae_14param_2channel/proxy_dual\proxy_Ytr_norm.npy
D:\Miniconda\envs\DL\Lib\site-packages\torch\optim\lr_scheduler.py:182: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn(
 >> Epoch 001 | Train Total=8.1061 | Val post/prior Total=46.0934/12.4722, Recon post/prior=1.1848/1.2967, KL=73.4722, | CycSim post total/iv/gm=0.8156/0.3557/0.4599, | CycSim prior total/iv/gm=1.1155/0.4950/0.6205, | CycMeas total/iv/gm=0.5049/0.2387/0.2663, | PriorBnd post/prior=1.24e-02/2.26e-02 | Best inf | Patience 1/40
[Update] best val_total_post improved to 46.093389 @ epoch 1
 >> Epoch 002 | Train Total=4.9727 | Val post/prior Total=33.8231/7.5965, Recon post/prior=1.1608/1.2238, KL=51.2544, | CycSim post total/iv/gm=0.7019/0.3063/0.3957, | CycSim prior total/iv/gm=0.6354/0.2783/0.3572, | CycMeas total/iv/gm=0.3824/0.1851/0.1973, | PriorBnd post/prior=1.36e-02/1.70e-02 | Best 46.0934 | Patience 1/40
[Update] best val_total_post improved to 33.823102 @ epoch 2
 >> Epoch 003 | Train Total=4.4220 | Val post/prior Total=32.5963/7.4113, Recon post/prior=1.1544/1.2000, KL=50.5266, | CycSim post total/iv/gm=0.6163/0.2660/0.3503, | CycSim prior total/iv/gm=0.6194/0.2694/0.3499, | CycMeas total/iv/gm=0.3132/0.1534/0.1598, | PriorBnd post/prior=1.56e-02/1.79e-02 | Best 33.8231 | Patience 1/40
[Update] best val_total_post improved to 32.596288 @ epoch 3
 >> Epoch 004 | Train Total=4.1370 | Val post/prior Total=30.0234/7.4609, Recon post/prior=1.1141/1.1515, KL=45.8494, | CycSim post total/iv/gm=0.5971/0.2591/0.3380, | CycSim prior total/iv/gm=0.6293/0.2726/0.3568, | CycMeas total/iv/gm=0.2384/0.1119/0.1265, | PriorBnd post/prior=1.33e-02/1.68e-02 | Best 32.5963 | Patience 1/40
[Update] best val_total_post improved to 30.023356 @ epoch 4
 >> Epoch 005 | Train Total=3.9786 | Val post/prior Total=31.0223/7.2271, Recon post/prior=1.1148/1.1623, KL=48.1800, | CycSim post total/iv/gm=0.5804/0.2502/0.3302, | CycSim prior total/iv/gm=0.6048/0.2606/0.3442, | CycMeas total/iv/gm=0.1339/0.0573/0.0766, | PriorBnd post/prior=1.55e-02/2.02e-02 | Best 30.0234 | Patience 1/40
 >> Epoch 006 | Train Total=3.8301 | Val post/prior Total=31.8913/7.0475, Recon post/prior=1.1201/1.1672, KL=50.3660, | CycSim post total/iv/gm=0.5574/0.2391/0.3183, | CycSim prior total/iv/gm=0.5862/0.2498/0.3364, | CycMeas total/iv/gm=0.3274/0.1517/0.1757, | PriorBnd post/prior=1.75e-02/2.36e-02 | Best 30.0234 | Patience 2/40
 >> Epoch 007 | Train Total=3.7056 | Val post/prior Total=33.1018/6.8060, Recon post/prior=1.1012/1.1583, KL=53.7932, | CycSim post total/iv/gm=0.5090/0.2210/0.2880, | CycSim prior total/iv/gm=0.5631/0.2412/0.3219, | CycMeas total/iv/gm=0.0988/0.0372/0.0616, | PriorBnd post/prior=1.63e-02/2.33e-02 | Best 30.0234 | Patience 3/40
 >> Epoch 008 | Train Total=3.6133 | Val post/prior Total=36.1435/6.6006, Recon post/prior=1.1002/1.1578, KL=59.7966, | CycSim post total/iv/gm=0.5131/0.2229/0.2902, | CycSim prior total/iv/gm=0.5425/0.2334/0.3090, | CycMeas total/iv/gm=0.3046/0.1380/0.1666, | PriorBnd post/prior=1.69e-02/2.54e-02 | Best 30.0234 | Patience 4/40
 >> Epoch 009 | Train Total=3.5529 | Val post/prior Total=40.1450/6.7476, Recon post/prior=1.1002/1.1593, KL=68.0273, | CycSim post total/iv/gm=0.5017/0.2191/0.2827, | CycSim prior total/iv/gm=0.5571/0.2410/0.3162, | CycMeas total/iv/gm=0.1097/0.0453/0.0644, | PriorBnd post/prior=1.60e-02/2.38e-02 | Best 30.0234 | Patience 5/40
 >> Epoch 010 | Train Total=3.4776 | Val post/prior Total=43.0883/6.2479, Recon post/prior=1.1010/1.1614, KL=74.2359, | CycSim post total/iv/gm=0.4855/0.2129/0.2726, | CycSim prior total/iv/gm=0.5069/0.2211/0.2858, | CycMeas total/iv/gm=0.0552/0.0282/0.0270, | PriorBnd post/prior=1.84e-02/2.75e-02 | Best 30.0234 | Patience 6/40
 >> Epoch 011 | Train Total=3.4725 | Val post/prior Total=46.3962/6.5295, Recon post/prior=1.1229/1.1797, KL=80.9573, | CycSim post total/iv/gm=0.4780/0.2090/0.2689, | CycSim prior total/iv/gm=0.5332/0.2306/0.3025, | CycMeas total/iv/gm=0.0698/0.0434/0.0263, | PriorBnd post/prior=2.02e-02/2.83e-02 | Best 30.0234 | Patience 7/40
 >> Epoch 012 | Train Total=3.4233 | Val post/prior Total=54.2603/6.0566, Recon post/prior=1.0993/1.1631, KL=97.0787, | CycSim post total/iv/gm=0.4607/0.2032/0.2576, | CycSim prior total/iv/gm=0.4876/0.2128/0.2748, | CycMeas total/iv/gm=0.0640/0.0338/0.0302, | PriorBnd post/prior=1.79e-02/2.73e-02 | Best 30.0234 | Patience 8/40
 >> Epoch 013 | Train Total=3.3919 | Val post/prior Total=63.9481/6.1982, Recon post/prior=1.1190/1.1841, KL=116.5880, | CycSim post total/iv/gm=0.4520/0.1992/0.2528, | CycSim prior total/iv/gm=0.4996/0.2171/0.2825, | CycMeas total/iv/gm=0.0772/0.0455/0.0317, | PriorBnd post/prior=1.92e-02/2.77e-02 | Best 30.0234 | Patience 9/40
 >> Epoch 014 | Train Total=3.3493 | Val post/prior Total=80.3112/6.0194, Recon post/prior=1.1148/1.1833, KL=149.6744, | CycSim post total/iv/gm=0.4344/0.1912/0.2432, | CycSim prior total/iv/gm=0.4818/0.2102/0.2715, | CycMeas total/iv/gm=0.0836/0.0504/0.0332, | PriorBnd post/prior=1.83e-02/2.66e-02 | Best 30.0234 | Patience 10/40
 >> Epoch 015 | Train Total=3.3055 | Val post/prior Total=85.2120/5.9611, Recon post/prior=1.1302/1.1971, KL=159.5165, | CycSim post total/iv/gm=0.4308/0.1905/0.2403, | CycSim prior total/iv/gm=0.4744/0.2080/0.2664, | CycMeas total/iv/gm=0.1562/0.0836/0.0726, | PriorBnd post/prior=2.05e-02/2.80e-02 | Best 30.0234 | Patience 11/40
 >> Epoch 016 | Train Total=3.2609 | Val post/prior Total=101.7591/5.7131, Recon post/prior=1.1226/1.1872, KL=192.9847, | CycSim post total/iv/gm=0.4129/0.1826/0.2303, | CycSim prior total/iv/gm=0.4505/0.1975/0.2531, | CycMeas total/iv/gm=0.2420/0.1204/0.1216, | PriorBnd post/prior=2.00e-02/2.68e-02 | Best 30.0234 | Patience 12/40
 >> Epoch 017 | Train Total=3.2413 | Val post/prior Total=99.8882/5.7240, Recon post/prior=1.1219/1.1871, KL=189.2863, | CycSim post total/iv/gm=0.4108/0.1813/0.2294, | CycSim prior total/iv/gm=0.4516/0.1974/0.2543, | CycMeas total/iv/gm=0.2048/0.1035/0.1012, | PriorBnd post/prior=2.09e-02/2.93e-02 | Best 30.0234 | Patience 13/40
 >> Epoch 018 | Train Total=3.2298 | Val post/prior Total=128.5839/5.7188, Recon post/prior=1.1297/1.1994, KL=246.5505, | CycSim post total/iv/gm=0.4163/0.1823/0.2341, | CycSim prior total/iv/gm=0.4498/0.1947/0.2551, | CycMeas total/iv/gm=0.2542/0.1258/0.1284, | PriorBnd post/prior=2.09e-02/3.01e-02 | Best 30.0234 | Patience 14/40
 >> Epoch 019 | Train Total=3.2205 | Val post/prior Total=160.2479/5.4255, Recon post/prior=1.1122/1.1731, KL=310.1354, | CycSim post total/iv/gm=0.4053/0.1783/0.2270, | CycSim prior total/iv/gm=0.4232/0.1846/0.2387, | CycMeas total/iv/gm=0.2061/0.1129/0.0932, | PriorBnd post/prior=1.92e-02/2.65e-02 | Best 30.0234 | Patience 15/40
 >> Epoch 020 | Train Total=3.1867 | Val post/prior Total=187.8289/5.3056, Recon post/prior=1.1342/1.1954, KL=365.5935, | CycSim post total/iv/gm=0.3882/0.1700/0.2182, | CycSim prior total/iv/gm=0.4088/0.1782/0.2307, | CycMeas total/iv/gm=0.2468/0.1254/0.1214, | PriorBnd post/prior=2.17e-02/2.96e-02 | Best 30.0234 | Patience 16/40
 >> Epoch 021 | Train Total=3.1839 | Val post/prior Total=175.4275/5.5783, Recon post/prior=1.1509/1.2125, KL=340.9020, | CycSim post total/iv/gm=0.3809/0.1677/0.2132, | CycSim prior total/iv/gm=0.4340/0.1885/0.2455, | CycMeas total/iv/gm=0.4177/0.1979/0.2198, | PriorBnd post/prior=2.43e-02/3.43e-02 | Best 30.0234 | Patience 17/40
 >> Epoch 022 | Train Total=3.1670 | Val post/prior Total=228.4018/5.4705, Recon post/prior=1.1297/1.1923, KL=447.0246, | CycSim post total/iv/gm=0.3744/0.1632/0.2112, | CycSim prior total/iv/gm=0.4255/0.1834/0.2421, | CycMeas total/iv/gm=0.3501/0.1665/0.1835, | PriorBnd post/prior=1.93e-02/2.76e-02 | Best 30.0234 | Patience 18/40
 >> Epoch 023 | Train Total=3.1065 | Val post/prior Total=236.4273/5.3448, Recon post/prior=1.1479/1.2016, KL=462.6840, | CycSim post total/iv/gm=0.3921/0.1726/0.2195, | CycSim prior total/iv/gm=0.4119/0.1797/0.2321, | CycMeas total/iv/gm=0.3897/0.1898/0.1999, | PriorBnd post/prior=2.27e-02/2.95e-02 | Best 30.0234 | Patience 19/40
 >> Epoch 024 | Train Total=3.1046 | Val post/prior Total=318.6763/5.1340, Recon post/prior=1.1334/1.1831, KL=627.5601, | CycSim post total/iv/gm=0.3747/0.1642/0.2105, | CycSim prior total/iv/gm=0.3927/0.1710/0.2216, | CycMeas total/iv/gm=0.3824/0.1812/0.2012, | PriorBnd post/prior=2.15e-02/2.76e-02 | Best 30.0234 | Patience 20/40
 >> Epoch 025 | Train Total=3.1208 | Val post/prior Total=301.1692/5.3091, Recon post/prior=1.1414/1.1853, KL=592.7109, | CycSim post total/iv/gm=0.3656/0.1568/0.2088, | CycSim prior total/iv/gm=0.4100/0.1745/0.2355, | CycMeas total/iv/gm=0.3539/0.1711/0.1828, | PriorBnd post/prior=2.42e-02/2.74e-02 | Best 30.0234 | Patience 21/40
 >> Epoch 026 | Train Total=3.1108 | Val post/prior Total=351.6065/4.9917, Recon post/prior=1.1331/1.1721, KL=694.1407, | CycSim post total/iv/gm=0.3387/0.1450/0.1937, | CycSim prior total/iv/gm=0.3794/0.1607/0.2188, | CycMeas total/iv/gm=0.4610/0.2163/0.2447, | PriorBnd post/prior=2.50e-02/2.98e-02 | Best 30.0234 | Patience 22/40
 >> Epoch 027 | Train Total=3.0770 | Val post/prior Total=612.0537/5.2412, Recon post/prior=1.1172/1.1541, KL=1215.1178, | CycSim post total/iv/gm=0.3363/0.1434/0.1929, | CycSim prior total/iv/gm=0.4061/0.1696/0.2364, | CycMeas total/iv/gm=0.5737/0.2670/0.3067, | PriorBnd post/prior=2.13e-02/2.42e-02 | Best 30.0234 | Patience 23/40
 >> Epoch 028 | Train Total=3.0796 | Val post/prior Total=517.0719/5.0413, Recon post/prior=1.1003/1.1353, KL=1025.4697, | CycSim post total/iv/gm=0.3222/0.1384/0.1838, | CycSim prior total/iv/gm=0.3880/0.1621/0.2259, | CycMeas total/iv/gm=0.5501/0.2625/0.2876, | PriorBnd post/prior=1.99e-02/2.28e-02 | Best 30.0234 | Patience 24/40
 >> Epoch 029 | Train Total=3.0552 | Val post/prior Total=365.2985/4.5000, Recon post/prior=1.1531/1.1693, KL=721.0264, | CycSim post total/iv/gm=0.3615/0.1511/0.2104, | CycSim prior total/iv/gm=0.3302/0.1364/0.1938, | CycMeas total/iv/gm=0.5449/0.2520/0.2929, | PriorBnd post/prior=3.51e-02/3.66e-02 | Best 30.0234 | Patience 25/40
 >> Epoch 030 | Train Total=3.0320 | Val post/prior Total=572.4611/5.1873, Recon post/prior=1.1029/1.1283, KL=1135.2992, | CycSim post total/iv/gm=0.3693/0.1566/0.2127, | CycSim prior total/iv/gm=0.4031/0.1690/0.2341, | CycMeas total/iv/gm=0.5803/0.2754/0.3049, | PriorBnd post/prior=2.78e-02/3.20e-02 | Best 30.0234 | Patience 26/40
 >> Epoch 031 | Train Total=3.0251 | Val post/prior Total=480.2424/5.0022, Recon post/prior=1.0714/1.1017, KL=951.4454, | CycSim post total/iv/gm=0.3435/0.1454/0.1980, | CycSim prior total/iv/gm=0.3871/0.1631/0.2241, | CycMeas total/iv/gm=0.6814/0.3111/0.3703, | PriorBnd post/prior=2.24e-02/2.74e-02 | Best 30.0234 | Patience 27/40
 >> Epoch 032 | Train Total=2.9946 | Val post/prior Total=544.2956/5.3300, Recon post/prior=1.1026/1.1290, KL=1079.2906, | CycSim post total/iv/gm=0.3532/0.1490/0.2042, | CycSim prior total/iv/gm=0.4173/0.1754/0.2419, | CycMeas total/iv/gm=0.5343/0.2545/0.2798, | PriorBnd post/prior=3.06e-02/3.44e-02 | Best 30.0234 | Patience 28/40
 >> Epoch 033 | Train Total=2.9862 | Val post/prior Total=598.2153/5.0805, Recon post/prior=1.0795/1.0981, KL=1186.9228, | CycSim post total/iv/gm=0.3660/0.1540/0.2120, | CycSim prior total/iv/gm=0.3955/0.1660/0.2294, | CycMeas total/iv/gm=0.5699/0.2668/0.3031, | PriorBnd post/prior=2.48e-02/2.72e-02 | Best 30.0234 | Patience 29/40
 >> Epoch 034 | Train Total=2.9698 | Val post/prior Total=464.3074/4.7006, Recon post/prior=1.1044/1.1323, KL=919.7238, | CycSim post total/iv/gm=0.3325/0.1390/0.1935, | CycSim prior total/iv/gm=0.3538/0.1466/0.2072, | CycMeas total/iv/gm=0.5903/0.2726/0.3177, | PriorBnd post/prior=3.22e-02/3.57e-02 | Best 30.0234 | Patience 30/40
 >> Epoch 035 | Train Total=2.9542 | Val post/prior Total=390.5852/5.0576, Recon post/prior=1.0730/1.1031, KL=771.2643, | CycSim post total/iv/gm=0.3865/0.1592/0.2273, | CycSim prior total/iv/gm=0.3924/0.1620/0.2303, | CycMeas total/iv/gm=0.5980/0.2729/0.3251, | PriorBnd post/prior=3.48e-02/4.39e-02 | Best 30.0234 | Patience 31/40
 >> Epoch 036 | Train Total=2.9245 | Val post/prior Total=402.5960/5.5278, Recon post/prior=1.0930/1.1281, KL=794.7642, | CycSim post total/iv/gm=0.4105/0.1694/0.2411, | CycSim prior total/iv/gm=0.4365/0.1788/0.2577, | CycMeas total/iv/gm=0.6765/0.3066/0.3699, | PriorBnd post/prior=3.40e-02/4.49e-02 | Best 30.0234 | Patience 32/40
 >> Epoch 037 | Train Total=2.8960 | Val post/prior Total=469.0946/5.4650, Recon post/prior=1.0791/1.1105, KL=927.3820, | CycSim post total/iv/gm=0.4309/0.1776/0.2534, | CycSim prior total/iv/gm=0.4320/0.1762/0.2558, | CycMeas total/iv/gm=0.7140/0.3180/0.3960, | PriorBnd post/prior=3.15e-02/4.22e-02 | Best 30.0234 | Patience 33/40
 >> Epoch 038 | Train Total=2.9002 | Val post/prior Total=606.6397/5.8279, Recon post/prior=1.0846/1.1291, KL=1202.1060, | CycSim post total/iv/gm=0.4486/0.1842/0.2644, | CycSim prior total/iv/gm=0.4661/0.1894/0.2768, | CycMeas total/iv/gm=0.7472/0.3361/0.4111, | PriorBnd post/prior=3.52e-02/4.84e-02 | Best 30.0234 | Patience 34/40
 >> Epoch 039 | Train Total=2.8928 | Val post/prior Total=517.5913/5.5867, Recon post/prior=1.0705/1.1035, KL=1024.0059, | CycSim post total/iv/gm=0.4503/0.1838/0.2665, | CycSim prior total/iv/gm=0.4445/0.1802/0.2643, | CycMeas total/iv/gm=0.8272/0.3665/0.4608, | PriorBnd post/prior=3.31e-02/4.18e-02 | Best 30.0234 | Patience 35/40
 >> Epoch 040 | Train Total=2.9218 | Val post/prior Total=528.7323/6.4687, Recon post/prior=1.0755/1.1060, KL=1045.0048, | CycSim post total/iv/gm=0.5139/0.2110/0.3029, | CycSim prior total/iv/gm=0.5326/0.2164/0.3162, | CycMeas total/iv/gm=0.7419/0.3327/0.4092, | PriorBnd post/prior=3.48e-02/4.31e-02 | Best 30.0234 | Patience 36/40
 >> Epoch 041 | Train Total=2.8823 | Val post/prior Total=455.1150/6.5677, Recon post/prior=1.0353/1.0691, KL=898.7533, | CycSim post total/iv/gm=0.4690/0.1919/0.2770, | CycSim prior total/iv/gm=0.5463/0.2211/0.3252, | CycMeas total/iv/gm=0.7343/0.3222/0.4121, | PriorBnd post/prior=2.55e-02/3.42e-02 | Best 30.0234 | Patience 37/40
 >> Epoch 042 | Train Total=2.8505 | Val post/prior Total=519.6472/6.1496, Recon post/prior=1.0569/1.0727, KL=1028.6354, | CycSim post total/iv/gm=0.4258/0.1732/0.2526, | CycSim prior total/iv/gm=0.5043/0.2027/0.3016, | CycMeas total/iv/gm=0.6655/0.2892/0.3763, | PriorBnd post/prior=3.12e-02/3.53e-02 | Best 30.0234 | Patience 38/40
 >> Epoch 043 | Train Total=2.8373 | Val post/prior Total=599.8832/6.4676, Recon post/prior=1.0482/1.0724, KL=1187.6581, | CycSim post total/iv/gm=0.4992/0.2019/0.2973, | CycSim prior total/iv/gm=0.5359/0.2147/0.3212, | CycMeas total/iv/gm=0.7145/0.3132/0.4013, | PriorBnd post/prior=3.16e-02/3.90e-02 | Best 30.0234 | Patience 39/40
 >> Epoch 044 | Train Total=2.8351 | Val post/prior Total=464.7908/6.8629, Recon post/prior=1.0494/1.0937, KL=917.1861, | CycSim post total/iv/gm=0.5134/0.2043/0.3091, | CycSim prior total/iv/gm=0.5732/0.2260/0.3472, | CycMeas total/iv/gm=0.6718/0.2858/0.3860, | PriorBnd post/prior=3.62e-02/5.04e-02 | Best 30.0234 | Patience 40/40
[EarlyStop] at epoch 44
[Diag] Start to calcaulte diag in test preocess... 
[Diag] wrote 373 rows to temp_Unidi_cvae_14param_2channel\cvae_20251128-024859\diag_test.csv
[Diag] proxy_floor_ps  P50=0.0116  P90=0.0402  P95=0.0526  P99=0.0856
[Test] prior total=7.522838 | prior recon=1.149990 | kl=46.284948 | prior cyc_sim=0.633372 | cyc_meas=0.238445 | prior_l2=1.511877 | prior_bnd=0.016677 | 
